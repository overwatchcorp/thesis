---
editor_options:
  chunk_output_type: console
output: pdf_document
---
# Results

```{r results_init, include=FALSE}
library(thesisdown)
library(kableExtra)
library(formattable)
library(tidyverse)
library(infer)
library(broom)
library(here)
library(ggpubr)
library(ggsci)
library(factoextra)
library(diptest)
source(here("index", "analysis", "qualtrics.R"))
```
```{r helper_functions, include = FALSE}
# makes p value text for reporting e.g. *p* = 0.09, *p* < 0.001
pval_text <- function (p) {
  val <- case_when(
    p < 0.001 ~  "< 0.001",
    p < 0.01 ~  "< 0.01",
    TRUE ~ paste("= ", round(p, digits = 2))
  )
  paste("*p*", val)
}
anova_text <- function(a) {
  a %>%
    mutate_if(is.numeric, round, digits = 2) %>%
    mutate(t = paste("*F*(",df, ", ", last(a$df), ") = ", statistic, ", ", pval_text(p.value),sep = ""))
}
desc_text <- function(d) {
  d %>%
    mutate_if(is.numeric, round, digits = 2) %>%
    mutate(t = paste("(*M* = ", mean, ", *SD* = ", sd, ")", sep = ""))
}
```
## Demographics
### Gender
I collected gender-related demographic data by asking participants to write in their gender identity and answer a series of yes/no questions: "Are you cisgender?," "Are you transgender?," and "Is your gender non-binary?" Answering yes on one question did not force the participants to answer no on others—this treated gender identity as a collection of separate, related labels that participants may or may not identify with simultaneously. Responses for the write-in question were qualitatively coded by me. 

```{r gender_descriptives, echo=FALSE}
qual_nonbinary_n <- mod_data %>% filter(`gender.non-binary` == TRUE) %>% nrow()
```
Overall, `r mod_data %>% filter(cis == TRUE) %>% nrow()` participants identified as cisgender, `r mod_data %>% filter(trans == TRUE) %>% nrow()` identified as transgender, and `r mod_data %>% filter(nonbinary == TRUE) %>% nrow()` identified their gender as non-binary. It is important to note that there is overlap among these groups. `r mod_data %>% filter(trans == TRUE, nonbinary == TRUE) %>% nrow()` participants said they were transgender and non-binary, `r mod_data %>% filter(cis == TRUE, nonbinary == TRUE) %>% nrow()` participants said they were cisgender and non-binary, and 1 participant said they were cisgender, transgender, and non-binary. 

Qualitative themes were decided by the author after examining the data and consulting with a number of gender-diverse peers. The most commonly occuring themes were woman (*N* = `r mod_data %>% filter(gender.woman == TRUE) %>% nrow()`), man (*N* = `r mod_data %>% filter(gender.man == TRUE) %>% nrow()`), non-binary (*N* = `r qual_nonbinary_n`), cisgender (*N* = `r mod_data %>% filter(gender.cisgender == TRUE) %>% nrow()`), transgender (*N* = `r mod_data %>% filter(gender.transgender == TRUE) %>% nrow()`), questioning (*N* = `r mod_data %>% filter(gender.questioning_gender == TRUE) %>% nrow()`), masculine (*N* = `r mod_data %>% filter(gender.masculine == TRUE) %>% nrow()`), agender (*N* = `r mod_data %>% filter(gender.agender == TRUE) %>% nrow()`), genderfluid (*N* = `r mod_data %>% filter(gender.genderfluid == TRUE) %>% nrow()`), and queer (*N* = `r mod_data %>% filter(gender.queer_gender == TRUE) %>% nrow()`). 

For the purposes of analysis, seven *artificial* gender groups were created: cisgender man, cisgender woman, transgender man, transgender woman, cisgender non-binary person, non-binary person, and transgender non-binary person. It is important to note that these bins are artificial and are not representative of each individual's own gender and experience. For example, "non-binary" can have many meanings and is best understood as an umbrella term that encompasses many genders, including individuals who's gender is just "non-binary."

The cisgender man and cisgender woman groups include all participants that only indicated that they were cisgender and indicated that they were a man or woman in the write-in gender field. The transgender man and transgender woman groups were the same as the cisgender groups, but included participants who indicated that they were transgender. 

The cisgender non-binary group includes all participants who indicated that they were cisgender and non-binary. This group includes cisgender non-binary men and cisgender non-binary women. The non-binary group includes all participants that only indicated that they were non-binary, as well as participants who indicated that they were neither cisgender nor transgender. This group includes non-binary men and non-binary women. The transgender non-binary group includes all participants that indicated that they were non-binary and transgender. This group includes transgender non-binary men and transgender non-binary women.
```{r, echo = FALSE}
mod_data %>%
  filter(!is.na(gender_bin)) %>%
  group_by(gender_bin) %>%
  tally() %>%
  arrange(-n) %>%
  kable(
    col.names = c("Gender Bin", "N")
  )
```

### Pronouns
Participants were asked their pronouns in a write-in box. Pronouns were qualitatively coded by the author. No participants reported using any other pronouns besides he/him, she/her, and they/them. However, many participants reported using multiple pronouns. It should be noted that individuals that use multiple pronouns may prefer one over the other, or use different pronouns in specific situations. This is not reflected in these data. 
```{r, echo = FALSE}
mod_data %>%
  filter(!is.na(pronoun_bin)) %>%
  group_by(pronoun_bin) %>%
  tally() %>%
  arrange(n * -1) %>%
  kable(
    col.names = c("Pronouns", "N"),
    caption = "Participant pronouns"
  )
```

```{r genderandpronouns_inorder, echo = FALSE}
genderandpronouns_inorder <- mod_data %>%
  filter(!is.na(gender_bin)) %>%
  group_by(gender_bin, pronoun_bin) %>%
  tally(sort = TRUE) %>%
  mutate(t = paste("(*N* = ", n, ")", sep = ""))
```
The most common gender and pronoun combinations were cisgender women that used she/her, `r genderandpronouns_inorder$t[1]`, cisgender men that used he/him, `r genderandpronouns_inorder$t[2]`, transgender non-binary people that used they/them, `r genderandpronouns_inorder$t[3]`, non-binary people that used they/them, `r genderandpronouns_inorder$t[4]`, non-binary people that used she/her and they/them, `r genderandpronouns_inorder$t[5]`, trans men that used he/him, `r genderandpronouns_inorder$t[6]`, and trans women that used she/her, `r genderandpronouns_inorder$t[7]`. 

### Sexuality
```{r bipan_overlap, echo = FALSE}
bipan_overlap <- mod_data %>% filter(sexuality.bisexual == TRUE | sexuality.pansexual == TRUE) %>% 
  group_by(sexuality.bisexual, sexuality.pansexual) %>% 
  tally() %>%
  mutate(t = paste("(*N* = ", n, ")", sep = ""))
```
Participants were asked to report their sexuality in a write-in field. Responses were qualitatively coded by the author. Many responses were coded with multiple themes, so the total *N* exceeds the sample size. One exceptionally common response was "bisexual/pansexual," `r bipan_overlap$t[3]`, which was coded with both themes.
```{r, echo = FALSE}
sexuality_labels <- data.frame(label = c("Bisexual", "Straight", "Pansexual", "Queer", "Questioning", "Gay", "Lesbian", "Asexual", "Aspec"))
mod_data %>%
  select(starts_with("sexuality.")) %>%
  summarise_all(function(x) sum(x == TRUE, na.rm = TRUE)) %>%
  select(-c(sexuality.demisexual, sexuality.polyamorous, sexuality.enbian)) %>%
  pivot_longer(everything(), names_to = "sexuality", values_to = "n") %>%
  cbind(sexuality_labels) %>%
  select(label, n) %>%
  kable(
    col.names = c("Sexuality", "N")
  )
```
```{r genderandsexuality_inorder, echo = FALSE}
genderandsexuality_inorder <- mod_data %>%
  filter(!is.na(gender_bin)) %>%
  group_by(gender_bin) %>%
  select(gender_bin, starts_with("sexuality.")) %>%
  summarise_all(function(x) sum(x == TRUE, na.rm = TRUE)) %>%
  pivot_wider(names_from = gender_bin, values_from = -c(gender_bin)) %>%
  pivot_longer(everything(), names_to = "group", values_to = "n") %>%
  arrange(-n) %>%
  mutate(t = paste("(*N* = ", n, ")", sep = ""))
```
The most common gender and sexualities were bisexual cisgender women, `r genderandsexuality_inorder$t[1]`, straight cisgender men, `r genderandsexuality_inorder$t[2]`, straight cisgender women, `r genderandsexuality_inorder$t[3]`, bisexual non-binary people, `r genderandsexuality_inorder$t[4]`, bisexual cisgender men, `r genderandsexuality_inorder$t[5]`, and bisexual transgender non-binary people, `r genderandsexuality_inorder$t[6]`. 

## Experiences with Misgendering
```{r misgendering_descriptives, echo=FALSE}
misgendering_desc <- mod_data %>%
  filter(!is.na(misgendering_freq), !is.na(misgendering_stigma)) %>%
  group_by(cis) %>%
  select(cis, misgendering_freq, misgendering_stigma) %>%
  summarise_all(funs(mean, sd)) %>%
  mutate_if(is.numeric, round, digits = 2)
```
```{r misgendering_freq, echo=FALSE}
# misgendering freq in cisgender people
misgendering_freq_cis <- mod_data %>%
  filter(!is.na(misgendering_freq), cis == TRUE) %>%
  map_df(rev) %>%
  group_by(misgendering_freq) %>%
  summarise(n = n()) %>%
  mutate(cis_freq = round(n / sum(n) * 100, digits = 1)) %>%
  select(cis_freq)
# misgendering freq in non-cisgender people
misgendering_freq_noncis <- mod_data %>%
  filter(!is.na(misgendering_freq), cis == FALSE) %>%
  map_df(rev) %>%
  group_by(misgendering_freq) %>%
  summarise(n = n()) %>%
  mutate(noncis_freq = round(n / sum(n) * 100, digits = 1)) %>%
  select(misgendering_freq, noncis_freq)
# comparing cis and non-cis people misgendering frequency
misgendering_freq_cisvsnoncis <- mod_data %>%
  t_test(misgendering_freq ~ cis, order = c(FALSE, TRUE)) %>%
  mutate_if(is.numeric, round, digits = 2)
```
```{r misgendering_stigma, echo=FALSE}
# misgendering freq in cisgender people
misgendering_stigma_cis <- mod_data %>%
  filter(!is.na(misgendering_stigma), cis == TRUE) %>%
  map_df(rev) %>%
  group_by(misgendering_stigma) %>%
  summarise(n = n()) %>%
  mutate(cis_stigma = round(n / sum(n) * 100, digits = 1)) %>%
  select(cis_stigma)
# misgendering stigma in non-cisgender people
misgendering_stigma_noncis <- mod_data %>%
  filter(!is.na(misgendering_stigma), cis == FALSE) %>%
  map_df(rev) %>%
  group_by(misgendering_stigma) %>%
  summarise(n = n()) %>%
  mutate(noncis_stigma = round(n / sum(n) * 100, digits = 1)) %>%
  select(misgendering_stigma, noncis_stigma)
# comparing cis and non-cis people misgendering stigmauency
misgendering_stigma_cisvsnoncis <- mod_data %>%
  t_test(misgendering_stigma ~ cis, order = c(FALSE, TRUE))
```

Similar to @mclemoreExperiencesMisgenderingIdentity2015, we had participants report how frequently they were misgendered and how stigmatized misgendering made them feel. However, unlike @mclemoreExperiencesMisgenderingIdentity2015, we administered these questions to cisgender people as well. Independent t-tests were used to compare the cisgender and non-cisgender participants. Non-cisgender participants (*M* = `r misgendering_desc$misgendering_freq_mean[1]`, *SD* = `r misgendering_desc$misgendering_freq_sd[1]`) reported being misgendered more frequently than cisgender participants (*M* = `r misgendering_desc$misgendering_freq_mean[2]`, *SD* = `r misgendering_desc$misgendering_freq_mean[2]`), *t*(`r misgendering_freq_cisvsnoncis$t_df`) = `r round(misgendering_freq_cisvsnoncis$statistic, digits = 1)`, *p* < 0.001.
Non-cisgender participants (*M* = `r misgendering_desc$misgendering_stigma_mean[1]`, *SD* = `r misgendering_desc$misgendering_stigma_sd[1]`) also reported feeling more stigmatized when misgendered than than cisgender participants (*M* = `r misgendering_desc$misgendering_stigma_mean[2]`, *SD* = `r misgendering_desc$misgendering_stigma_mean[2]`), *t*(`r misgendering_stigma_cisvsnoncis$t_df`) = `r round(misgendering_stigma_cisvsnoncis$statistic, digits = 1)`, *p* < 0.001. 


<!-- misgendering freq table -->
```{r, echo=FALSE}
cbind(misgendering_freq_noncis, misgendering_freq_cis) %>%
    mutate_at(vars("misgendering_freq"),
              funs(recode(., "5" = "Always", "4" = "Often", "3" = "Sometimes", "2" = "Rarely", "1" = "Never"))) %>%
kable(
  col.names = c("“How often do people ‘misgender’ you?”", "Non-cisgender (%)", "Cisgender (%)"),
  caption = "Misgendering frequency for non-cisgender and cisgender participants"
  )
```

<!-- misgendering stigma table -->
```{r, echo=FALSE}
cbind(misgendering_stigma_noncis, misgendering_stigma_cis) %>%
    mutate_at(vars("misgendering_stigma"),
              funs(recode(., "5" = "Very", "4" = "Considerably", "3" = "Somewhat", "2" = "Slightly", "1" = "Not at all"))) %>%
kable(
  col.names = c("“I feel stigmatized (looked down upon)when I am misgendered.”", "Non-cisgender (%)", "Cisgender (%)"),
  caption = "Felt stigma when misgendered for non-cisgender and cisgender participants"
  )
```

```{r misgendering_freq_chisq, include=FALSE}
# comparing my data (non-cis) to mclemore data
# proprtion of responses
mclemore_study1_misgendering_freq_prop <- c(10.4, 29.6, 27.0, 30.4, 2.6)
mclemore_study2_misgendering_freq_prop <- c(6.7, 23.9, 25.4, 32.8, 11.2)
# multiple by sample size
mclemore_study1_misgendering_freq <- mclemore_study1_misgendering_freq_prop / 100 * 115
mclemore_study2_misgendering_freq <- mclemore_study2_misgendering_freq_prop / 100 * 134
# tally our misgendering frequency data
fung_misgendering_freq <- mod_data %>% 
  filter(!is.na(misgendering_freq), cis == TRUE) %>% 
  group_by(misgendering_freq) %>% 
  tally() %>% 
  select(n) %>%
  rename("fung_misgendering_freq" = n)
# combine mclemore and our data into a tibble
all_misgendering_freq <- tibble(mclemore_study1_misgendering_freq,
                                mclemore_study2_misgendering_freq,
                                fung_misgendering_freq)
study1_chisq <- all_misgendering_freq %>% select(mclemore_study1_misgendering_freq, fung_misgendering_freq) %>%
  chisq.test()
study2_chisq <- all_misgendering_freq %>% select(mclemore_study2_misgendering_freq, fung_misgendering_freq) %>%
  chisq.test()
```
Pearson's Chi-squared tests were used to compare the misgendering frequency observed in @mclemoreExperiencesMisgenderingIdentity2015 to the non-cisgender participants in the present study. 
There were significant differences when compared to both the study 1 population, *X<sup>2</sup>* (`r study1_chisq$parameter`, *N* = `r sum(study1_chisq$observed, study1_chisq$expected)`) = `r round(study1_chisq$statistic, digits = 2)`, *p* = `r round(study1_chisq$p.value, digits = 2)`, and the study 2 population, *X<sup>2</sup>* (`r study2_chisq$parameter`, *N* = `r sum(study2_chisq$observed, study2_chisq$expected)`) = `r round(study2_chisq$statistic, digits = 2)`, *p* = `r round(study2_chisq$p.value, digits = 2)`.

```{r misgendering_anova, echo=FALSE}
misgendering_freq_anova <- aov(misgendering_freq ~ gender_bin, mod_data) %>%
  tidy() %>%
  mutate(p.value = round(p.value, digits = 4))
misgendering_stigma_anova <- aov(misgendering_stigma ~ gender_bin, mod_data) %>%
  tidy() %>%
  mutate(p.value = round(p.value, digits = 4))
```
@mclemoreExperiencesMisgenderingIdentity2015 performed a one-way ANOVA "to compare differences among three gender groups (transgender men, transgender women, and genderqueer)" in misgendering frequency and felt stigma when misgendered.
Because a different approach was taken in collecting gender-related demographic data, we performed a factorial ANOVA comparing endorsement of several endorsed identities on misgendering frequency and felt stigma. 

There were multiple significant effects of identity endorsement on misgendering frequency. 
Cisgender, *F*(`r misgendering_freq_anova$df[1]`, `r tail(misgendering_freq_anova$df,1)`) = `r round(misgendering_freq_anova$statistic[1], digits = 2)`, *p* < 0.001,
transgender, *F*(`r misgendering_freq_anova$df[2]`, `r tail(misgendering_freq_anova$df,1)`) = `r round(misgendering_freq_anova$statistic[2], digits = 2)`, *p* < 0.001,
and non-binary identity, *F*(`r misgendering_freq_anova$df[3]`, `r tail(misgendering_freq_anova$df,1)`) = `r round(misgendering_freq_anova$statistic[3], digits = 2)`, *p* < 0.001, all demonstrated significant effects. 
There was no significant effect in women (*p* = `r round(misgendering_freq_anova$p.value[5], digits = 2)`) or men (*p* = `r round(misgendering_freq_anova$p.value[4], digits = 2)`) alone. 
However, there was a significant effect in transgender women, *F*(`r misgendering_freq_anova$df[7]`, `r tail(misgendering_freq_anova$df,1)`) = `r round(misgendering_freq_anova$statistic[7], digits = 2)`, *p* < 0.001. 
There was not a significant effect in transgender men (*p* = `r round(misgendering_freq_anova$p.value[6], digits = 2)`). 
There was also a significant effect in non-binary women , *F*(`r misgendering_freq_anova$df[7]`, `r tail(misgendering_freq_anova$df,1)`) = `r round(misgendering_freq_anova$statistic[7], digits = 2)`, *p* = `r round(misgendering_freq_anova$p.value[9], digits = 3)`, 
but not in non-binary men (*p* = `r round(misgendering_freq_anova$p.value[8], digits = 3)`).

There were also multiple sigificant effects of identity endorsement on felt stigma when misgendered. 
Cisgender, *F*(`r misgendering_stigma_anova$df[1]`, `r tail(misgendering_stigma_anova$df,1)`) = `r round(misgendering_stigma_anova$statistic[1], digits = 2)`, *p* < 0.001,
and transgender , *F*(`r misgendering_stigma_anova$df[2]`, `r tail(misgendering_stigma_anova$df,1)`) = `r round(misgendering_stigma_anova$statistic[2], digits = 2)`, *p* < 0.001, identities demonstrated significant effects. 
However, non-binary (*p* = `r round(misgendering_stigma_anova$p.value[3], digits = 2)`) identity did not show a significant effect. 
Neither men (*p* = `r round(misgendering_stigma_anova$p.value[4], digits = 2)`) nor women (*p* = `r round(misgendering_stigma_anova$p.value[5], digits = 2)`) alone showed significant effects, nor did trans women (*p* = `r round(misgendering_stigma_anova$p.value[7], digits = 2)`). 
However, trans men, *F*(`r misgendering_stigma_anova$df[6]`, `r tail(misgendering_stigma_anova$df,1)`) = `r round(misgendering_stigma_anova$statistic[6], digits = 2)`, *p* < 0.001, demonstrated a significant effect.
Neither non-binary men (*p* = `r round(misgendering_stigma_anova$p.value[8], digits = 2)`) nor non-binary women (*p* = `r round(misgendering_stigma_anova$p.value[9], digits = 2)`) demonstrated a significant effect. 

```{r misgendering_pronoun_anova, echo = FALSE}
# run factorial anova on pronouns
misgendering_pronoun_anova_raw <- mod_data %>%
  aov(misgendering_freq ~ pronoun.he + pronoun.they + cis:pronoun.he + cis:pronoun.they, .)
# tidy anova data
misgendering_pronoun_anova <- misgendering_pronoun_anova_raw %>% tidy()
# run and tidy tukey test
misgendering_pronoun_tukey <- misgendering_pronoun_anova_raw %>%
  TukeyHSD() %>%
  tidy()
```

Unlike @mclemoreExperiencesMisgenderingIdentity2015, participant pronouns were also collected. This allowed us to perform a factorial ANOVA with a follow-up Tukey test to examine pronouns, independent of gender, had an effect on misgendering frequency. I will finish this paragraph later lol once i figure out if it's actually relevant or not lol.


## Gender Congruence
@kozeeMeasuringTransgenderIndividuals2012 developed the TCS (Transgender Congruence Scale) to measure transgender individuals' relationship and comfort between their inner gender identity, physical appearance, and social experience of gender. In this study, the TCS was administered to cisgender participants as well. 

```{r congruence_results, echo = FALSE}
cong_desc <- mod_data %>%
  filter(!is.na(congruence)) %>%
  group_by(cis) %>%
  summarise(mean_cong = mean(congruence), sd_cong = sd(congruence)) %>%
  mutate_if(is.numeric, round, digits = 2)
cong_ttest <- mod_data %>%
  filter(!is.na(congruence)) %>%
  t_test(congruence ~ cis, order = c(FALSE, TRUE)) %>%
  mutate_if(is.numeric, round, digits = 2)
# congruence anova
cong_anova <- mod_data %>%
  aov(congruence ~ gender_bin, .) %>%
  tidy() %>%
  mutate_if(is.numeric, round, digits = 2)
```

A single sample t-test revealed that non-cisgender participants (*M* = `r cong_desc$mean_cong[1]`, *SD* = `r cong_desc$sd_cong[1]`) scored lower on the TCS than cisgender participants (*M* = `r cong_desc$mean_cong[2]`, *SD* = `r cong_desc$sd_cong[2]`), *t*(`r cong_ttest$t_df`) = `r cong_ttest$statistic`, *p* < 0.001. 

A factorial ANOVA demonstrated significant effects of cisgender, *F*(`r cong_anova$df[1]`, `r tail(cong_anova$df,1)`) = `r cong_anova$statistic[1]`, *p* < 0.001,
and non-binary identification, *F*(`r cong_anova$df[3]`, `r tail(cong_anova$df,1)`) = `r cong_anova$statistic[3]`, *p* < 0.001, 
but not of transgender identification (*p* = `r cong_anova$p.value[2]`). 
There were also no significant effects in men (*p* = `r cong_anova$p.value[4]`), women (*p* = `r cong_anova$p.value[5]`), trans men (*p* = `r cong_anova$p.value[6]`), trans women (*p* = `r cong_anova$p.value[7]`), non-binary men (*p* = `r cong_anova$p.value[8]`), and non-binary women (*p* = `r cong_anova$p.value[9]`). 

```{r congruence_graph, echo = FALSE, warning=FALSE}
cisman_cong <- mod_data %>%
  filter(!is.na(congruence), cis == TRUE & nonbinary == FALSE & trans == FALSE & gender.man == TRUE & gender.woman == FALSE) %>%
  summarise(median = median(congruence))
mod_data %>%
  filter(gender_bin != "other", !is.na(congruence)) %>%
  ggplot(aes(x = gender_bin, y = congruence)) +
  geom_boxplot() +
  xlab("Gender") +
  ylab("Gender Congruence") +
  geom_hline(yintercept = cisman_cong$median, linetype = 2) +
  stat_compare_means(label = "p.signif", ref.group = "Cis Man")
```

## Transgender Inclusive Behaviors

```{r inclusive_results, echo = FALSE, include = FALSE}
inclusive_desc <- mod_data %>%
  filter(!is.na(inclusive_behavior)) %>%
  group_by(cis) %>%
  summarise(mean_inc = mean(inclusive_behavior), sd_inc = sd(inclusive_behavior), n = n()) %>%
  mutate_if(is.numeric, round, digits = 2)
inclusive_ttest <- mod_data %>%
  filter(!is.na(inclusive_behavior)) %>%
  t_test(inclusive_behavior ~ cis, order = c(FALSE, TRUE)) %>%
  mutate_if(is.numeric, round, digits = 2)
# congruence anova
inclusive_anova_raw <- mod_data %>%
  aov(inclusive_behavior ~ gender_bin + ethnicity + year + major + age + sexuality, .) 
inclusive_anova <- inclusive_anova_raw %>%
  tidy() %>%
  mutate_if(is.numeric, round, digits = 2)
# congruence tukey
inclusive_tukey <- inclusive_anova_raw %>%
  TukeyHSD() %>%
  tidy() %>%
  filter(adj.p.value < 0.05) %>%
  mutate_if(is.numeric, round, digits = 2)
inclusive_tukey_text <- mod_data %>%
  filter(!is.na(inclusive_behavior), !is.na(gender_bin)) %>%
  group_by(gender_bin) %>%
  summarise(mean = mean(inclusive_behavior), sd = sd(inclusive_behavior)) %>%
  mutate_if(is.numeric, round, digits = 2) %>%
  mutate(t = paste("(*M* = ", mean, ", *SD* = ", sd, ")", sep = ""))
```

@kattariDevelopmentValidationTransgender2018 developed the Transgender Inclusive Behavior Scale (TIBS) as a method of quantifying the number of behaviors that may support and include transgender people that one regularly does. Scores are a sum of responses on a series of five-point likert scales ranging from "Never" to "Often."

A single-sample t-test revealed that non-cisgender people (*M* = `r inclusive_desc$mean_inc[1]`, *SD* = `r inclusive_desc$sd_inc[1]`) reporting performing more inclusive behaviors than cisgender people (*M* = `r inclusive_desc$mean_inc[2]`, *SD* = `r inclusive_desc$sd_inc[2]`), *t*(`r inclusive_ttest$t_df`) = `r inclusive_ttest$statistic`, *p* < 0.001.

A one-way ANOVA demonstrated that there was a significant effect of gender *F*(`r inclusive_anova$df[1]`, `r tail(inclusive_anova$df, 1)`) = `r inclusive_anova$statistic[1]`, *p* < 0.001.
A Tukey post-hoc comparison revealed that cisgender men `r inclusive_tukey_text$t[1]` do significantly fewer trans inclusive behaviors than cisgender women `r inclusive_tukey_text$t[2]`, transgender men `r inclusive_tukey_text$t[3]`, transgender women `r inclusive_tukey_text$t[4]`, cisgender non-binary people `r inclusive_tukey_text$t[5]`, non-binary people `r inclusive_tukey_text$t[6]`, and transgender non-binary people `r inclusive_tukey_text$t[7]`. Cisgender women do significantly fewer trans inclusive behaviors than transgender men, transgender women, non-binary people, and transgender non-binary people. Cisgender non-binary people also do fewer trans inclusive behaviors than transgender non-binary people. 

```{r incl_behavior_graph, echo = FALSE, warning=FALSE}
cisman_inc <- mod_data %>%
  filter(!is.na(inclusive_behavior), cis == TRUE & nonbinary == FALSE & trans == FALSE & gender.man == TRUE & gender.woman == FALSE) %>%
  summarise(median = median(inclusive_behavior))
# comparisons <- list(c("Cis Man", "Cis Woman"), c("Trans Man", "Trans Woman"), c("Non-binary", "Trans Non-binary"))
mod_data %>%
  filter(!is.na(inclusive_behavior), !is.na(gender_bin)) %>%
  ggplot(aes(x = gender_bin, y = inclusive_behavior)) +
  geom_boxplot() +
  xlab("Gender") +
  ylab("Transgender Inclusive Behaviors") +
  #stat_compare_means(comparisons = comparisons)
  geom_hline(yintercept = cisman_inc$median, linetype = 2) +
  stat_compare_means(label = "p.signif", ref.group = "Cis Man")
```

## Pronouns

### Comfort sharing pronouns
<!-- includes items 1, 2, 3, 7, 8, 9 -->
```{r comfort_sharing, echo = FALSE, include=FALSE}
comfort_setting_data <- mod_data %>%
  select(
    gender_bin,
    pronoun_bin,
    comfort_general,
    comfort_reed,
    comfort_class
  ) %>%
  filter(complete.cases(.)) %>%
  pivot_longer(starts_with("comfort_"), names_to = "factor", values_to = "val")
comfort_setting_anova_raw <- comfort_setting_data %>%
  aov(val ~ factor + pronoun_bin + gender_bin + factor:gender_bin + factor:pronoun_bin, .)
comfort_setting_anova <- comfort_setting_anova_raw %>% tidy() %>% anova_text()
comfort_setting_tukey <- comfort_setting_anova_raw %>%
  TukeyHSD() %>%
  tidy() %>%
  filter(adj.p.value < 0.05)
comfort_desc_setting_factor <- comfort_setting_data %>%
  group_by(factor) %>%
  summarise(mean = mean(val), sd = sd(val)) %>%
  desc_text()
comfort_desc_setting_pronoun <- comfort_setting_data %>%
  group_by(pronoun_bin) %>%
  summarise(mean = mean(val), sd = sd(val)) %>%
  desc_text()
comfort_desc_setting_gender <- comfort_setting_data %>%
  group_by(gender_bin) %>%
  summarise(mean = mean(val), sd = sd(val)) %>%
  desc_text()
comfort_desc_setting_factorgender <- comfort_setting_data %>%
  group_by(factor, gender_bin) %>%
  summarise(mean = mean(val), sd = sd(val)) %>%
  desc_text()
comfort_desc_setting_factorpronoun <- comfort_setting_data %>%
  group_by(factor, pronoun_bin) %>%
  summarise(mean = mean(val), sd = sd(val)) %>%
  desc_text()
```
Items 1, 2, 3, 7, 8, and 9 touched on participant's comfort sharing their pronouns.
A factorial ANOVA found a significant effect of setting, gender, and pronouns on comfort sharing pronouns, `r comfort_setting_anova$t[1]`. A post-hoc Tukey test found that generally, students are more comfortable sharing pronouns in class, `r comfort_desc_setting_factor$t[1]`, and in non-academic settings at Reed, `r comfort_desc_setting_factor$t[3]`, than they are in general, `r comfort_desc_setting_factor$t[2]`. It also found that cisgender men, `r comfort_desc_setting_gender$t[1]`, are more comfortable sharing their pronouns than trans men, `r comfort_desc_setting_gender$t[3]`, trans women, `r comfort_desc_setting_gender$t[4]`, and non-binary people, `r comfort_desc_setting_gender$t[6]`. **There are a lot of other effects (126 total!) and I'm not sure how to report all of them.**

### Desire to share pronouns
<!-- includes items 4, 5, 6 -->

### Concerns about sharing pronouns
<!-- includes items 10, 11, 12 -->

### Congruence and perception of pronouns
<!-- includes items 13, 14, 15, 16, 17 18 -->

### Historical experience at Reed College
<!-- includes items 19, 20, 21 -->


### Primary Component Analysis
```{r pca, echo = FALSE}
pca_all <- mod_data %>%
  select(
    cis,
    trans,
    nonbinary,
    gender.man,
    gender.woman,
    gender_bin,
    pronoun_bin,
    comfort_general,
    comfort_reed,
    comfort_class,
    desire_general,
    desire_reed,
    desire_class,
    comfort_withsimilargenders,
    comfort_someoneelsefirst,
    comfort_proffirst,
    attention_general,
    attention_reed,
    attention_class,
    gender_perception_consistent,
    gender_pronouns_consistent,
    pronouns_represent,
    willmisgender_ifnopronouns,
    assume_pronouns_correctly,
    understand_better,
    profs_share,
    students_share,
    reed_support,
    misgendering_freq,
    misgendering_stigma
    ) %>%
  mutate(gender.man = as.numeric(gender.man), gender.woman = as.numeric(gender.woman), nonbinary = as.numeric(nonbinary), trans = as.numeric(trans), cis = as.numeric(cis)) %>%
  filter(complete.cases(.))

pca_in <- pca_all %>% select(-c(pronoun_bin, gender_bin))
pca_desc <-  pca_all %>% select(c(pronoun_bin, gender_bin))

# perform PCA
pca_out <- pca_in %>%
  prcomp(scale = FALSE)
# get factor loadings
loadings <- pca_out %>%
  tidy("rotation") %>%
  pivot_wider(names_from = PC, values_from = value) %>%
  select(column, `1`, `2`, `3`) %>% 
  mutate_if(is.numeric, round, digits = 2)
variance <- pca_out %>%
  tidy("pcs")
eigenvals <- get_eigenvalue(pca_out) %>% mutate_if(is.numeric, round, digits = 2)
```
Principal component analysis (PCA) was used on the pronoun and misgendering data. Using a Screen plot, we retained three components with an eigenvalue of `r eigenvals$eigenvalue[3]`, accounting for `r eigenvals$cumulative.variance.percent[3]`% of the variance. 
```{r, echo = FALSE}
# color tile function that can take more than one color, since we want very positive and very negative values to be highlighted, but not
# intermediate values
color_tile2 <- function (...) {
  formatter("span", style = function(x) {
    style(display = "block",
          padding = "0 4px", 
          `border-radius` = "4px", 
          `background-color` = csscolor(matrix(as.integer(colorRamp(...)(normalize(as.numeric(x)))), 
                                               byrow=TRUE, dimnames=list(c("red","green","blue"), NULL), nrow=3)))
  })}
loadings %>%
  mutate(
    `1` = color_tile2(c("gray", "white", "white", "white", "lightgray", "gray"))(`1`),
    `2` = color_tile2(c("gray", "white", "white", "white", "lightgray", "gray"))(`2`),
    `3` = color_tile2(c("gray", "white", "white", "white", "lightgray", "gray"))(`3`)
  ) %>%
  kable(
    "html",
    escape = FALSE,
    col.names = c("Item", "Comp. 1", "Comp. 2", "Comp. 3")
  )
```
Inspection of the first component's loadings indicate that concern that consistency between others' perception of one's gender, others' assumptions about gender and pronouns, misgendering, and comfort when with people with similar genders to one's own are making significant contributions to the first component. Because these items are mainly concerned with the assumptions other people place on one's gender and pronouns, this component appears to be the amount that cisnormative assumptions about one's gender and appearance harms individuals. 

Loadings from the second component encompasses one's desire to share one's pronouns in various settings, as well as how comfortable one feels doing so. Because the largest loading in the second component is one's desire to share pronouns, this seems to indicate one's readiness to share pronouns. 

Loadings from the third component emphasize concern that sharing one's pronouns will draw unwanted attention, as well as when others—not necessarily of the same gender—share their pronouns first and how consistent and representative one's pronouns are with one's gender. This component appears to represent concern around sharing pronouns and fears of judgment or lack of understanding about one's pronouns. 

```{r pca_colors, echo = FALSE}
colors <- pal_jco("default")(8) %>% tail(7)
colors[2] = "#925E9FFF"
```
```{r pca_vis_selection, echo = FALSE}
fill_data <- pca_all %>%
  mutate(match = factor(case_when(
    gender_bin == "Cis Man" ~ "Cis Man",
    gender_bin == "Cis Woman" ~ "Cis Woman",
    gender_bin == "Trans Man" ~ "Trans Man",
    gender_bin == "Trans Woman" ~ "Trans Woman",
    gender_bin == "Cis Non-binary" ~ "Cis Non-binary",
    gender_bin == "Non-binary" ~ "Non-binary",
    gender_bin == "Trans Non-binary" ~ "Trans Non-binary",
    TRUE ~ "Other"
  )))
fill_cis <- pca_all %>%
  mutate(match = factor(case_when(
    gender_bin == "Cis Man" ~ "Cis Man",
    gender_bin == "Cis Woman" ~ "Cis Woman",
    gender_bin == "Cis Non-binary" ~ "Cis Non-binary",
    TRUE ~ "Other"
  )))
fill_noncis <- pca_all %>%
  mutate(match = factor(case_when(
    gender_bin == "Trans Man" ~ "Trans Man",
    gender_bin == "Trans Woman" ~ "Trans Woman",
    gender_bin == "Non-binary" ~ "Non-binary",
    gender_bin == "Trans Non-binary" ~ "Trans Non-binary",
    TRUE ~ "Other"
  )))
fill_menwomen <- pca_all %>%
  mutate(match = factor(case_when(
    gender_bin == "Cis Man" ~ "Cis Man",
    gender_bin == "Cis Woman" ~ "Cis Woman",
    gender_bin == "Trans Man" ~ "Trans Man",
    gender_bin == "Trans Woman" ~ "Trans Woman",
    TRUE ~ "Other"
  )))
fill_nonbinary <- pca_all %>%
  mutate(match = factor(case_when(
    gender_bin == "Cis Non-binary" ~ "Cis Non-binary",
    gender_bin == "Non-binary" ~ "Non-binary",
    gender_bin == "Trans Non-binary" ~ "Trans Non-binary",
    TRUE ~ "Other"
  )))
```
```{r pca_vis, echo = FALSE, fig.widht = 11, fig.height= 12.5, cache = TRUE}
pca_component_var <- tidy(pca_out, "pcs") %>% mutate_if(is.numeric, round, digits = 3) %>% mutate(t = paste("(", percent * 100, "%)", sep = ""))
# graph of components 1 and 2, all genders
pca_vis_all <- pca_out %>%
  fviz_pca_ind(
    title = "",
    # select.ind = list(name = which(fill_data$match != "Other")),
    palette = colors,
    geom.ind = "point",
    pointshape = 21, 
    pointsize = 2, 
    axes = c(1,2),
    fill = fill_data$match,
    habillage = fill_data$match,
    addEllipses = TRUE,
    label = "var",
    repel = TRUE,
    legend.title = "Gender") +
  xlab(paste("Cisnormativity", pca_component_var$t[1])) +
  ylab(paste("Readiness to share pronouns", pca_component_var$t[2]))
pca_vis_cis <- pca_out %>%
  fviz_pca_ind(
    title = "",
    select.ind = list(name = which(fill_cis$match != "Other")),
    palette = colors[c(1,2,3)],
    geom.ind = "point",
    pointshape = 21, 
    pointsize = 2, 
    axes = c(1,2),
    fill = fill_data$match,
    habillage = fill_data$match,
    addEllipses = TRUE,
    label = "var",
    repel = TRUE,
    legend.title = "Gender") +
  theme(legend.position = "none") +
  xlab(paste("Cisnormativity", pca_component_var$t[1])) +
  ylab(paste("Readiness to share pronouns", pca_component_var$t[2]))
pca_vis_noncis <- pca_out %>%
  fviz_pca_ind(
    title = "",
    select.ind = list(name = which(fill_noncis$match != "Other")),
    palette = colors[c(4,5,6,7)],
    geom.ind = "point",
    pointshape = 21, 
    pointsize = 2, 
    axes = c(1,2),
    fill = fill_data$match,
    habillage = fill_data$match,
    addEllipses = TRUE,
    label = "var",
    repel = TRUE,
    legend.title = "Gender") +
  theme(legend.position = "none") +
  xlab(paste("Cisnormativity", pca_component_var$t[1])) +
  ylab(paste("Readiness to share pronouns", pca_component_var$t[2]))
pca_vis_menwomen <- pca_out %>%
  fviz_pca_ind(
    title = "",
    select.ind = list(name = which(fill_menwomen$match != "Other")),
    palette = colors[c(1, 3, 5, 7)],
    geom.ind = "point",
    pointshape = 21, 
    pointsize = 2, 
    axes = c(1,2),
    fill = fill_data$match,
    habillage = fill_data$match,
    addEllipses = TRUE,
    label = "var",
    repel = TRUE,
    legend.title = "Gender") +
  theme(legend.position = "none") +
  xlab(paste("Cisnormativity", pca_component_var$t[1])) +
  ylab(paste("Readiness to share pronouns", pca_component_var$t[2]))
pca_vis_nonbinary <- pca_out %>%
  fviz_pca_ind(
    title = "",
    select.ind = list(name = which(fill_nonbinary$match != "Other")),
    palette = colors[c(2, 4, 6)],
    geom.ind = "point",
    pointshape = 21, 
    pointsize = 2, 
    axes = c(1,2),
    fill = fill_data$match,
    habillage = fill_data$match,
    addEllipses = TRUE,
    label = "var",
    repel = TRUE,
    legend.title = "Gender") +
  theme(legend.position = "none") +
  xlab(paste("Cisnormativity", pca_component_var$t[1])) +
  ylab(paste("Readiness to share pronouns", pca_component_var$t[2]))
ggarrange(pca_vis_all,
          ggarrange(pca_vis_cis,
                    pca_vis_noncis,
                    pca_vis_menwomen,
                    pca_vis_nonbinary,
                    labels = c("Cisgender individuals", "Non-cisgender individuals", "Men and women", "Non-binary individuals")
                    ),
          nrow = 2,
          heights = c(1.2, 1.8),
          labels = "All individuals") %>%
  annotate_figure(top = text_grob("PCA Components 1 & 2 by Gender", face = "bold", size = 14))
```
```{r comp1_anova, echo = FALSE}
pca_comp1_out <- tidy(pca_out, "u") %>%
  filter(PC == 1) %>%
  cbind(pca_all)
comp1_anova_raw <- pca_comp1_out %>%
  aov(value ~ gender_bin, .)
comp1_anova <- tidy(comp1_anova_raw) %>%
  mutate_if(is.numeric, round, digits = 2) %>%
  mutate(t = paste("*F*(", df, ", ", .$df[2], ") = ", statistic, ", ", pval_text(p.value),sep = ""))
comp1_tukey <- comp1_anova_raw %>%
  TukeyHSD() %>%
  tidy() %>%
  filter(adj.p.value < 0.05) %>%
  mutate_if(is.numeric, round, digits = 3)
comp1_desc <- pca_comp1_out %>%
  group_by(gender_bin) %>%
  summarise(mean = mean(value), sd = sd(value)) %>%
  mutate_if(is.numeric, round, digits = 2) %>%
  mutate(t = paste("(*M* = ", mean, ", *SD* = ", sd, ")", sep = ""))
```
A one-way ANOVA demonstrated a significant effect of gender on the first component, `r comp1_anova$t[1]`. A post-hoc Tukey test revealed that cisgender men, `r comp1_desc$t[1]`, and women, `r comp1_desc$t[2]`, are significantly less affected by cisnormativity than trans men, `r comp1_desc$t[3]`, trans women, `r comp1_desc$t[4]`, cisgender non-binary people, `r comp1_desc$t[5]`, non-binary people, `r comp1_desc$t[6]`, and transgender non-binary people, `r comp1_desc$t[7]`. Cisgender non-binary people are also less affected than trans men, trans women, non-binary people, and transgender non-binary people. Trans non-binary people are also more affected than non-binary people.  
```{r comp1_bimodal_check, echo = FALSE}
comp1_bimodal <- tidy(pca_out, "u") %>%
  filter(PC == 1) %>%
  select(value) %>%
  unlist() %>%
  dip.test() %>%
  tidy() %>%
  mutate_if(is.numeric, round, digits = 3) %>%
  mutate(t = paste("(*D* = ", statistic, ", *p* = ", p.value, ")", sep = ""))
# visualize 
tidy(pca_out, "x") %>% 
  filter(PC == 1) %>% 
  cbind(pca_all) %>% 
  ggplot(aes(x = value)) + 
  geom_dotplot(aes(fill = factor(gender_bin, levels = c("Cis Man", "Cis Non-binary", "Cis Woman", "Non-binary", "Trans Man", "Trans Non-binary", "Trans Woman"))), stackgroups = T, binpositions="all", binwidth = 0.28) +
  scale_fill_manual(values = colors) + 
  labs(fill = "Gender") +
  xlab("Experienced Cisnormativity") +
  # y axis isn't really meaningful, so hide it
  scale_y_continuous(NULL, breaks = NULL)
```
Visualization of the first component indicated possible bimodality along the first component. Hartigan's dip test indicated that the distribution along the first component is unlikely to be unimodal, `r comp1_bimodal$t[1]`. This indicates that experiences with cisnormativity may be as bimodal. This indicates that cisgender and non-cisgender people may have significantly different experiences navigating the world as their gender. 


```{r comp2_anova, echo = FALSE}
pca_comp2_out <- tidy(pca_out, "u") %>%
  filter(PC == 2) %>%
  cbind(pca_all)
comp2_anova_raw <- pca_comp2_out %>%
  aov(value ~ gender_bin, .)
comp2_anova <- tidy(comp2_anova_raw) %>%
  mutate_if(is.numeric, round, digits = 2) %>%
  mutate(t = paste("*F*(", df, ", ", .$df[2], ") = ", statistic, ", *p* < 0.001",sep = ""))
comp2_tukey <- comp2_anova_raw %>%
  TukeyHSD() %>%
  tidy() %>%
  filter(adj.p.value < 0.05) %>%
  mutate_if(is.numeric, round, digits = 3)
comp2_desc <- pca_comp2_out %>%
  group_by(gender_bin) %>%
  summarise(mean = mean(value), sd = sd(value)) %>%
  mutate_if(is.numeric, round, digits = 2) %>%
  mutate(t = paste("(*M* = ", mean, ", *SD* = ", sd, ")", sep = ""))
```
Another one-way ANOVA demonstrated a significant effect of gender on the second component, `r comp2_anova$t[1]`. A post-hoc Tukey test revealed that cisgender men, `r comp1_desc$t[1]`, are less willing to share their pronouns than cisgender women, `r comp1_desc$t[2]` trans men, `r comp1_desc$t[3]`, and non-binary people, `r comp1_desc$t[6]`. Non-binary people are also more willing to share their pronouns than transgender women, `r comp1_desc$t[4]`. 

```{r comp3_anova, echo = FALSE}
pca_comp3_out <- tidy(pca_out, "u") %>%
  filter(PC == 3) %>%
  cbind(pca_all)
comp3_anova_raw <- pca_comp3_out %>%
  aov(value ~ gender_bin, .)
comp3_anova <- tidy(comp3_anova_raw) %>%
  mutate_if(is.numeric, round, digits = 2) %>%
  mutate(t = paste("*F*(", df, ", ", .$df[2], ") = ", statistic, ", *p* < 0.001",sep = ""))
comp3_tukey <- comp3_anova_raw %>%
  TukeyHSD() %>%
  tidy() %>%
  filter(adj.p.value < 0.05) %>%
  mutate_if(is.numeric, round, digits = 3)
comp3_desc <- pca_comp3_out %>%
  group_by(gender_bin) %>%
  summarise(mean = mean(value), sd = sd(value)) %>%
  mutate_if(is.numeric, round, digits = 2) %>%
  mutate(t = paste("(*M* = ", mean, ", *SD* = ", sd, ")", sep = ""))
```
A final one-way ANOVA demonstrated a significant effect of gender on the third component, `r comp3_anova$t[1]`. Non-binary people, `r comp1_desc$t[6]`, are significantly less concerned that sharing their pronouns will draw unwanted attention than cisgender men, `r comp1_desc$t[1]`, cisgender women, `r comp1_desc$t[2]`, transgender men `r comp1_desc$t[3]`, and transgender women `r comp1_desc$t[4]`. There were no significant effects between any other groups.

```{r comp3_viz, echo = FALSE, fig.widht = 8, fig.height= 9}
comp3_fill_data <- pca_all %>%
  mutate(match = factor(case_when(
    gender_bin == "Cis Man" ~ "Cis Man",
    gender_bin == "Cis Woman" ~ "Cis Woman",
    gender_bin == "Trans Man" ~ "Trans Man",
    gender_bin == "Trans Woman" ~ "Trans Woman",
    gender_bin == "Non-binary" ~ "Non-binary",
    TRUE ~ "Other"
  )))
pca_comp3_vis_all <- pca_out %>%
    fviz_pca_ind(axes = c(1, 3),
        title = "",
        palette = colors,
        geom.ind = "point",
        pointshape = 21, 
        pointsize = 2, 
        fill = fill_data$match,
        habillage = fill_data$match,
        addEllipses = TRUE,
        label = "var",
        repel = TRUE,
        legend.title = "Gender") +
  xlab(paste("Cisnormativity", pca_component_var$t[1])) +
  ylab(paste("Concern about sharing pronouns", pca_component_var$t[3]))
pca_comp3_vis_signif <- pca_out %>%
    fviz_pca_ind(axes = c(1, 3),
        title = "",
        select.ind = list(name = which(comp3_fill_data$match != "Other")),
        palette = colors[c(1, 3, 4, 5, 7)],
        geom.ind = "point",
        pointshape = 21, 
        pointsize = 2, 
        fill = fill_data$match,
        habillage = fill_data$match,
        addEllipses = TRUE,
        label = "var",
        repel = TRUE,
        legend.title = "Gender") +
  theme(legend.position = "none") +
  xlab(paste("Cisnormativity", pca_component_var$t[1])) +
  ylab(paste("Concern about sharing pronouns", pca_component_var$t[3]))
ggarrange(pca_comp3_vis_all, pca_comp3_vis_signif,
          nrow = 2,
          labels = c("All individuals", "Men, women, and non-binary individuals")) %>%
  annotate_figure(top = text_grob("PCA Components 1 & 3 by Gender", face = "bold", size = 14))
```
However, this may be due to the fact that this is the third component which only accounts for `r pca_component_var$percent[3] * 100`% of the total variation. Visualization of the third component shows that there is considerable variation within groups. 